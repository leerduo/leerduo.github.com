<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="UI/UE,移动开发," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description" content="这部分主要是为了解决Android设备多屏幕的问题，设计兼容手机和平板或者TV等等的产品。主要分为三个部分的内容：


Supporting Different Screen Sizes(支持不同的屏幕尺寸)
Supporting Different Screen Densities(支持不同的屏幕密度)
Implementing Adaptive UI Flows(实现自适应的流UI)">
<meta property="og:type" content="article">
<meta property="og:title" content="training for the ninth part">
<meta property="og:url" content="http://chenfuduo.me/2015/06/29/training-for-the-ninth-part/index.html">
<meta property="og:site_name" content="louis.chen">
<meta property="og:description" content="这部分主要是为了解决Android设备多屏幕的问题，设计兼容手机和平板或者TV等等的产品。主要分为三个部分的内容：


Supporting Different Screen Sizes(支持不同的屏幕尺寸)
Supporting Different Screen Densities(支持不同的屏幕密度)
Implementing Adaptive UI Flows(实现自适应的流UI)">
<meta property="og:image" content="http://1.infotravel.sinaapp.com/pic/38.png">
<meta property="og:image" content="http://1.infotravel.sinaapp.com/pic/36.png">
<meta property="og:image" content="http://1.infotravel.sinaapp.com/pic/37.png">
<meta property="og:updated_time" content="2015-06-30T12:39:17.544Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="training for the ninth part">
<meta name="twitter:description" content="这部分主要是为了解决Android设备多屏幕的问题，设计兼容手机和平板或者TV等等的产品。主要分为三个部分的内容：


Supporting Different Screen Sizes(支持不同的屏幕尺寸)
Supporting Different Screen Densities(支持不同的屏幕密度)
Implementing Adaptive UI Flows(实现自适应的流UI)">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"always"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> training for the ninth part | louis.chen </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?63c029dba1e367df2c8ffa39a309056a";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>






  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">louis.chen</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">纸上得来终觉浅,绝知此事要躬行。</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-heartbeat fa-fw"></i> <br />
            
            公益404
          </a>
        </li>
      

      
      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                training for the ninth part
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-06-29T21:25:40+08:00" content="2015-06-29">
              2015-06-29
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/移动开发/" itemprop="url" rel="index">
                    <span itemprop="name">移动开发</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/06/29/training-for-the-ninth-part/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/06/29/training-for-the-ninth-part/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>这部分主要是为了解决Android设备多屏幕的问题，设计兼容手机和平板或者TV等等的产品。主要分为三个部分的内容：</p>
<blockquote>
<ul>
<li>Supporting Different Screen Sizes(支持不同的屏幕尺寸)</li>
<li>Supporting Different Screen Densities(支持不同的屏幕密度)</li>
<li>Implementing Adaptive UI Flows(实现自适应的流UI)</li>
</ul>
</blockquote>
<a id="more"></a>
<p>#效果<br>本篇的demo实现的效果如下：<br>手机上的效果：<br><img src="http://1.infotravel.sinaapp.com/pic/38.png" alt="手机"><br>平板上的竖屏效果：<br><img src="http://1.infotravel.sinaapp.com/pic/36.png" alt="平板上的竖屏效果"><br><img src="http://1.infotravel.sinaapp.com/pic/37.png" alt="平板上的横屏效果"></p>
<p>#支持不同的屏幕尺寸<br>通过一下的方式支持不同的屏幕尺寸：</p>
<blockquote>
<ul>
<li>确保布局可以充分调整大小以适应屏幕(Ensuring your layout can be adequately resized to fit the screen)</li>
<li>根据屏幕配置提供了相应的UI布局(Providing appropriate UI layout according to screen configuration)</li>
<li>确保正确的布局被应用到正确的屏幕(Ensuring the correct layout is applied to the correct screen)</li>
<li>提供规模合适的bitmaps(Providing bitmaps that scale correctly)</li>
</ul>
</blockquote>
<p>##使用”wrap_content”和”match_parent”<br>为了确保你的布局能灵活的适应不同的屏幕尺寸，针对一些view组件，你应该使用wrap_content和match_parent来设置他们的宽和高。如果你使用了wrap_content，view的宽和高会被设置为该view所包含的内容的大小值。如果是match_parent（在API 8之前是fill_parent）则会匹配该组件的父控件的大小。<br>通过使用wrap_content和match_parent尺寸值代替硬编码的尺寸，你的视图将分别只使用控件所需要的空间或者被拓展以填充所有有效的空间。比如：<br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">LinearLayout</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    <span class="attribute">android:orientation</span>=<span class="value">"vertical"</span></span><br><span class="line">    <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">    <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">LinearLayout</span> <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">                  <span class="attribute">android:id</span>=<span class="value">"@+id/linearLayout1"</span></span><br><span class="line">                  <span class="attribute">android:gravity</span>=<span class="value">"center"</span></span><br><span class="line">                  <span class="attribute">android:layout_height</span>=<span class="value">"50dp"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">ImageView</span> <span class="attribute">android:id</span>=<span class="value">"@+id/imageView1"</span></span><br><span class="line">                   <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span></span><br><span class="line">                   <span class="attribute">android:layout_width</span>=<span class="value">"wrap_content"</span></span><br><span class="line">                   <span class="attribute">android:src</span>=<span class="value">"@drawable/logo"</span></span><br><span class="line">                   <span class="attribute">android:paddingRight</span>=<span class="value">"30dp"</span></span><br><span class="line">                   <span class="attribute">android:layout_gravity</span>=<span class="value">"left"</span></span><br><span class="line">                   <span class="attribute">android:layout_weight</span>=<span class="value">"0"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">View</span> <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span></span><br><span class="line">              <span class="attribute">android:id</span>=<span class="value">"@+id/view1"</span></span><br><span class="line">              <span class="attribute">android:layout_width</span>=<span class="value">"wrap_content"</span></span><br><span class="line">              <span class="attribute">android:layout_weight</span>=<span class="value">"1"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">Button</span> <span class="attribute">android:id</span>=<span class="value">"@+id/categorybutton"</span></span><br><span class="line">                <span class="attribute">android:background</span>=<span class="value">"@drawable/button_bg"</span></span><br><span class="line">                <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span></span><br><span class="line">                <span class="attribute">android:layout_weight</span>=<span class="value">"0"</span></span><br><span class="line">                <span class="attribute">android:layout_width</span>=<span class="value">"120dp"</span></span><br><span class="line">                <span class="attribute">style</span>=<span class="value">"@style/CategoryButtonStyle"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">fragment</span> <span class="attribute">android:id</span>=<span class="value">"@+id/headlines"</span></span><br><span class="line">              <span class="attribute">android:layout_height</span>=<span class="value">"fill_parent"</span></span><br><span class="line">              <span class="attribute">android:name</span>=<span class="value">"com.example.android.newsreader.HeadlinesFragment"</span></span><br><span class="line">              <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>注意上面的例子使用wrap_content和match_parent来指定组件尺寸而不是使用固定的尺寸。这样就能使你的布局正确的适配不同的屏幕尺寸和屏幕方向（这里的配置主要是指屏幕的横竖屏切换）。</p>
<p>##使用RelativeLayout<br>你可以使用LinearLayout以及wrap_content和match_parent组合来构建复杂的布局，但是LinearLayout却不允许你精准的控制它子view的关系，子view在LinearLayout中只能简单一个接一个的排成行。如果你需要你的子view不只是简简单单的排成行的排列，更好的方法是使用RelativeLayout，它允许你指定你布局中控件与控件之间的关系，比如，你可以指定一个子view在左边，另一个则在屏幕的右边。<br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">RelativeLayout</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">    <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">TextView</span></span><br><span class="line">        <span class="attribute">android:id</span>=<span class="value">"@+id/label"</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span></span><br><span class="line">        <span class="attribute">android:text</span>=<span class="value">"Type here:"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">EditText</span></span><br><span class="line">        <span class="attribute">android:id</span>=<span class="value">"@+id/entry"</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span></span><br><span class="line">        <span class="attribute">android:layout_below</span>=<span class="value">"@id/label"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">Button</span></span><br><span class="line">        <span class="attribute">android:id</span>=<span class="value">"@+id/ok"</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">"wrap_content"</span></span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span></span><br><span class="line">        <span class="attribute">android:layout_below</span>=<span class="value">"@id/entry"</span></span><br><span class="line">        <span class="attribute">android:layout_alignParentRight</span>=<span class="value">"true"</span></span><br><span class="line">        <span class="attribute">android:layout_marginLeft</span>=<span class="value">"10dp"</span></span><br><span class="line">        <span class="attribute">android:text</span>=<span class="value">"OK"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">Button</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">"wrap_content"</span></span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span></span><br><span class="line">        <span class="attribute">android:layout_toLeftOf</span>=<span class="value">"@id/ok"</span></span><br><span class="line">        <span class="attribute">android:layout_alignTop</span>=<span class="value">"@id/ok"</span></span><br><span class="line">        <span class="attribute">android:text</span>=<span class="value">"Cancel"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>注意：尽管组件的尺寸发生了变化，但是它的子view之间的空间关系还是通过RelativeLayout.LayoutParams已经指定好了。</p>
</blockquote>
<p>##使用尺寸限定词(Use Size Qualifiers)<br>（译者注：这里的限定词主要是指在编写布局文件时，将布局文件放在加上类似<code>large，sw600dp</code>等这样限定词的文件夹中，以此来告诉系统根据屏幕选择对应的布局文件，比如下面例子的layout-large文件夹）<br>从上面的学习中，我们知道如何编写灵活的布局或者相对布局，它们都能通过拉伸或者填充控件来适应不同的屏幕，但是它们却不能为每个不同屏幕尺寸提供最好的用户体验。因此，你的应用不应该只是实现灵活的布局，同时也应该为不同的屏幕配置提供几种不同的布局方式。你可以通过配置限定（configuration qualifiers）来做这件事情，它能在运行时根据你当前设备的配置（比如不同的屏幕尺寸设计了不同的布局）来选择合适的布局资源。<br>比如，很多应用都为大屏幕实现了“两个窗格”模式（应用可能在一个窗格中实现一个list的item，另外一个则实现list的content），平板和电视都是大到能在一个屏幕上适应两个窗格，但是手机屏幕却只能分别显示。所以，如果你想实现这些布局，你就需要以下文件：<br>res/<code>layout</code>/main.xml.单个窗格（默认）布局：<br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">LinearLayout</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    <span class="attribute">android:orientation</span>=<span class="value">"vertical"</span></span><br><span class="line">    <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">    <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">fragment</span> <span class="attribute">android:id</span>=<span class="value">"@+id/headlines"</span></span><br><span class="line">              <span class="attribute">android:layout_height</span>=<span class="value">"fill_parent"</span></span><br><span class="line">              <span class="attribute">android:name</span>=<span class="value">"com.example.android.newsreader.HeadlinesFragment"</span></span><br><span class="line">              <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>res/<code>layout-large</code>/main.xml,两个窗格布局：<br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">LinearLayout</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    <span class="attribute">android:layout_width</span>=<span class="value">"fill_parent"</span></span><br><span class="line">    <span class="attribute">android:layout_height</span>=<span class="value">"fill_parent"</span></span><br><span class="line">    <span class="attribute">android:orientation</span>=<span class="value">"horizontal"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">fragment</span> <span class="attribute">android:id</span>=<span class="value">"@+id/headlines"</span></span><br><span class="line">              <span class="attribute">android:layout_height</span>=<span class="value">"fill_parent"</span></span><br><span class="line">              <span class="attribute">android:name</span>=<span class="value">"com.example.android.newsreader.HeadlinesFragment"</span></span><br><span class="line">              <span class="attribute">android:layout_width</span>=<span class="value">"400dp"</span></span><br><span class="line">              <span class="attribute">android:layout_marginRight</span>=<span class="value">"10dp"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">fragment</span> <span class="attribute">android:id</span>=<span class="value">"@+id/article"</span></span><br><span class="line">              <span class="attribute">android:layout_height</span>=<span class="value">"fill_parent"</span></span><br><span class="line">              <span class="attribute">android:name</span>=<span class="value">"com.example.android.newsreader.ArticleFragment"</span></span><br><span class="line">              <span class="attribute">android:layout_width</span>=<span class="value">"fill_parent"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>##使用最小宽度限定词(Use the Smallest-width Qualifier)<br>在Android 3.2之前，开发者还有一个困难，那就是Android设备的“large”屏幕尺寸，其中包括Dell Streak（设备名称），老版Galaxy Tab和一般的7寸平板，有很多的应用都想针对这些不同的设备（比如5和7寸的设备）定义不同的布局，但是这些设备都被定义为了large尺寸屏幕。也是因为这个，所以Android在3.2的时候开始使用最小宽度限定词。</p>
<p>最小宽度限定词允许你根据设备的最小宽度（dp单位）来指定不同布局。比如，传统的7寸平板最小宽度为600dp，如果你希望你的UI能够在这样的屏幕上显示两个窗格（不是一个窗格显示在小屏幕上），你可以使用上节中提到的使用同样的两个布局文件。不同的是，使用sw600来指定两个方框的布局使用在最小宽度为600dp的设备上。</p>
<p>res/<code>layout</code>/main.xml,单个窗格（默认）布局：<br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">LinearLayout</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    <span class="attribute">android:orientation</span>=<span class="value">"vertical"</span></span><br><span class="line">    <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">    <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">fragment</span> <span class="attribute">android:id</span>=<span class="value">"@+id/headlines"</span></span><br><span class="line">              <span class="attribute">android:layout_height</span>=<span class="value">"fill_parent"</span></span><br><span class="line">              <span class="attribute">android:name</span>=<span class="value">"com.example.android.newsreader.HeadlinesFragment"</span></span><br><span class="line">              <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>res/<code>layout-sw600dp</code>/main.xml,两个方框布局：<br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">LinearLayout</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    <span class="attribute">android:layout_width</span>=<span class="value">"fill_parent"</span></span><br><span class="line">    <span class="attribute">android:layout_height</span>=<span class="value">"fill_parent"</span></span><br><span class="line">    <span class="attribute">android:orientation</span>=<span class="value">"horizontal"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">fragment</span> <span class="attribute">android:id</span>=<span class="value">"@+id/headlines"</span></span><br><span class="line">              <span class="attribute">android:layout_height</span>=<span class="value">"fill_parent"</span></span><br><span class="line">              <span class="attribute">android:name</span>=<span class="value">"com.example.android.newsreader.HeadlinesFragment"</span></span><br><span class="line">              <span class="attribute">android:layout_width</span>=<span class="value">"400dp"</span></span><br><span class="line">              <span class="attribute">android:layout_marginRight</span>=<span class="value">"10dp"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">fragment</span> <span class="attribute">android:id</span>=<span class="value">"@+id/article"</span></span><br><span class="line">              <span class="attribute">android:layout_height</span>=<span class="value">"fill_parent"</span></span><br><span class="line">              <span class="attribute">android:name</span>=<span class="value">"com.example.android.newsreader.ArticleFragment"</span></span><br><span class="line">              <span class="attribute">android:layout_width</span>=<span class="value">"fill_parent"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>这样意味着当你的设备的最小宽度等于600dp或者更大时，系统选择layout-sw600dp/main.xml（两个窗格）的布局，而小一点的屏幕则会选择layout/main.xml（单个窗格）的布局。 然而，在3.2之前的设备上，这样做并不是很好的选择。因为3.2之前还没有将sw600dp作为一个限定词出现，所以，你还是需要使用large限定词来做。因此，你还是应该要有一个布局文件名为res/layout-large/main.xml，和res/layout-sw600dp/main.xml一样。在下一节中，你将学到如何避免像这样出现重复的布局文件。<br>注意第二个布局文件的目录名字“large qualifier”，在大尺寸的设备屏幕时（比如7寸平板或者其他大屏幕的设备）就会选择该布局文件，而其他比较小的设备则会选择没有限定词的另一个布局（也就是第一个布局文件）。</p>
<p>##使用布局别名(Use Layout Aliases)<br>最小宽度限定词只能在android3.2或者更高的版本上使用。因此，你还是需要使用抽象尺寸（small，normal，large，xlarge）来兼容以前的版本。比如，你想要将你的UI设计为在手机上只显示一个方框的布局，而在7寸平板或电视，或者其他大屏幕设备上显示多个方框的布局，你可能得提供这些文件：</p>
<blockquote>
<ul>
<li><p>res/layout/main.xml：单个窗格布局</p>
</li>
<li><p>res/layout-large：多个窗格布局</p>
</li>
<li><p>res/layout-sw600dp：多个窗格布局</p>
</li>
</ul>
</blockquote>
<p>最后两个文件都是一样的，因为其中一个将会适配Android3.2的设备，而另外一个则会适配其他Android低版本的平板或者电视。 为了避免这些重复的文件（维护让人感觉头痛就是因为这个），你可以使用别名文件。比如，你可以定义如下布局：</p>
<blockquote>
<ul>
<li>res/layout/main.xml，单个方框布局</li>
<li>res/layout/main_twopans.xml，两个方框布局</li>
</ul>
</blockquote>
<p>然后添加这两个文件：</p>
<ul>
<li><p>res/values-large/layout.xml：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">item</span> <span class="attribute">name</span>=<span class="value">"main"</span> <span class="attribute">type</span>=<span class="value">"layout"</span>&gt;</span>@layout/main_twopanes<span class="tag">&lt;/<span class="title">item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>res/values-sw600dp/layout.xml：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">resources</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">item</span> <span class="attribute">name</span>=<span class="value">"main"</span> <span class="attribute">type</span>=<span class="value">"layout"</span>&gt;</span>@layout/main_twopanes<span class="tag">&lt;/<span class="title">item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>最后两个文件拥有相同的内容，但它们并没有真正意义上的定义布局。它们只是将main_twopanes设置成为了别名main，它们分别处在large和sw600dp选择器中，所以它们能适配Android任何版本的平板和电视（在3.2之前平板和电视可以直接匹配large，而3.2或者以上的则匹配sw600dp）。</p>
<p>##使用方向限定词(Use Orientation Qualifiers)</p>
<p>有一些布局不管是在横向还是纵向的屏幕配置中都能显示的非常好，但是更多的时候，适当的调整一下会更好。在News Reader应用例子中，以下是布局在不同屏幕尺寸和方向的行为：</p>
<blockquote>
<ul>
<li>小屏幕，纵向：一个窗格加logo</li>
<li>小屏幕，横向：一个窗格加logo</li>
<li>7寸平板，纵向：一个窗格加action bar</li>
<li>7寸平板，横向：两个宽窗格加action bar</li>
<li>10寸平板，纵向：两个窄窗格加action bar</li>
<li>10寸平板，横向：两个宽窗格加action bar</li>
<li>电视，横向：两个宽窗格加action bar</li>
</ul>
</blockquote>
<p>这些每个布局都会在res/layout目录下定义一个xml文件，如此，应用就能根据屏幕配置的变化根据别名匹配到对应的布局来适应屏幕。</p>
<p>res/layout/onepane.xml：<br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">LinearLayout</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    <span class="attribute">android:orientation</span>=<span class="value">"vertical"</span></span><br><span class="line">    <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">    <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">fragment</span> <span class="attribute">android:id</span>=<span class="value">"@+id/headlines"</span></span><br><span class="line">              <span class="attribute">android:layout_height</span>=<span class="value">"fill_parent"</span></span><br><span class="line">              <span class="attribute">android:name</span>=<span class="value">"com.example.android.newsreader.HeadlinesFragment"</span></span><br><span class="line">              <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>res/layout/onepane_with_bar.xml:<br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">LinearLayout</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    <span class="attribute">android:orientation</span>=<span class="value">"vertical"</span></span><br><span class="line">    <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">    <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">LinearLayout</span> <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">                  <span class="attribute">android:id</span>=<span class="value">"@+id/linearLayout1"</span></span><br><span class="line">                  <span class="attribute">android:gravity</span>=<span class="value">"center"</span></span><br><span class="line">                  <span class="attribute">android:layout_height</span>=<span class="value">"50dp"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">ImageView</span> <span class="attribute">android:id</span>=<span class="value">"@+id/imageView1"</span></span><br><span class="line">                   <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span></span><br><span class="line">                   <span class="attribute">android:layout_width</span>=<span class="value">"wrap_content"</span></span><br><span class="line">                   <span class="attribute">android:src</span>=<span class="value">"@drawable/logo"</span></span><br><span class="line">                   <span class="attribute">android:paddingRight</span>=<span class="value">"30dp"</span></span><br><span class="line">                   <span class="attribute">android:layout_gravity</span>=<span class="value">"left"</span></span><br><span class="line">                   <span class="attribute">android:layout_weight</span>=<span class="value">"0"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">View</span> <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span></span><br><span class="line">              <span class="attribute">android:id</span>=<span class="value">"@+id/view1"</span></span><br><span class="line">              <span class="attribute">android:layout_width</span>=<span class="value">"wrap_content"</span></span><br><span class="line">              <span class="attribute">android:layout_weight</span>=<span class="value">"1"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">Button</span> <span class="attribute">android:id</span>=<span class="value">"@+id/categorybutton"</span></span><br><span class="line">                <span class="attribute">android:background</span>=<span class="value">"@drawable/button_bg"</span></span><br><span class="line">                <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span></span><br><span class="line">                <span class="attribute">android:layout_weight</span>=<span class="value">"0"</span></span><br><span class="line">                <span class="attribute">android:layout_width</span>=<span class="value">"120dp"</span></span><br><span class="line">                <span class="attribute">style</span>=<span class="value">"@style/CategoryButtonStyle"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">fragment</span> <span class="attribute">android:id</span>=<span class="value">"@+id/headlines"</span></span><br><span class="line">              <span class="attribute">android:layout_height</span>=<span class="value">"fill_parent"</span></span><br><span class="line">              <span class="attribute">android:name</span>=<span class="value">"com.example.android.newsreader.HeadlinesFragment"</span></span><br><span class="line">              <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>res/layout/twopanes.xml:<br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">LinearLayout</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    <span class="attribute">android:layout_width</span>=<span class="value">"fill_parent"</span></span><br><span class="line">    <span class="attribute">android:layout_height</span>=<span class="value">"fill_parent"</span></span><br><span class="line">    <span class="attribute">android:orientation</span>=<span class="value">"horizontal"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">fragment</span> <span class="attribute">android:id</span>=<span class="value">"@+id/headlines"</span></span><br><span class="line">              <span class="attribute">android:layout_height</span>=<span class="value">"fill_parent"</span></span><br><span class="line">              <span class="attribute">android:name</span>=<span class="value">"com.example.android.newsreader.HeadlinesFragment"</span></span><br><span class="line">              <span class="attribute">android:layout_width</span>=<span class="value">"400dp"</span></span><br><span class="line">              <span class="attribute">android:layout_marginRight</span>=<span class="value">"10dp"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">fragment</span> <span class="attribute">android:id</span>=<span class="value">"@+id/article"</span></span><br><span class="line">              <span class="attribute">android:layout_height</span>=<span class="value">"fill_parent"</span></span><br><span class="line">              <span class="attribute">android:name</span>=<span class="value">"com.example.android.newsreader.ArticleFragment"</span></span><br><span class="line">              <span class="attribute">android:layout_width</span>=<span class="value">"fill_parent"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>res/layout/twopanes_narrow.xml:<br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">LinearLayout</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    <span class="attribute">android:layout_width</span>=<span class="value">"fill_parent"</span></span><br><span class="line">    <span class="attribute">android:layout_height</span>=<span class="value">"fill_parent"</span></span><br><span class="line">    <span class="attribute">android:orientation</span>=<span class="value">"horizontal"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">fragment</span> <span class="attribute">android:id</span>=<span class="value">"@+id/headlines"</span></span><br><span class="line">              <span class="attribute">android:layout_height</span>=<span class="value">"fill_parent"</span></span><br><span class="line">              <span class="attribute">android:name</span>=<span class="value">"com.example.android.newsreader.HeadlinesFragment"</span></span><br><span class="line">              <span class="attribute">android:layout_width</span>=<span class="value">"200dp"</span></span><br><span class="line">              <span class="attribute">android:layout_marginRight</span>=<span class="value">"10dp"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">fragment</span> <span class="attribute">android:id</span>=<span class="value">"@+id/article"</span></span><br><span class="line">              <span class="attribute">android:layout_height</span>=<span class="value">"fill_parent"</span></span><br><span class="line">              <span class="attribute">android:name</span>=<span class="value">"com.example.android.newsreader.ArticleFragment"</span></span><br><span class="line">              <span class="attribute">android:layout_width</span>=<span class="value">"fill_parent"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>现在所有可能的布局我们都已经定义了，唯一剩下的问题是使用方向限定词来匹配对应的布局给屏幕。这时候，你就可以使用布局别名的功能了：</p>
<p>res/values/layouts.xml：<br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">item</span> <span class="attribute">name</span>=<span class="value">"main_layout"</span> <span class="attribute">type</span>=<span class="value">"layout"</span>&gt;</span>@layout/onepane_with_bar<span class="tag">&lt;/<span class="title">item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">bool</span> <span class="attribute">name</span>=<span class="value">"has_two_panes"</span>&gt;</span>false<span class="tag">&lt;/<span class="title">bool</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">resources</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>res/values-sw600dp-land/layouts.xml:<br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">item</span> <span class="attribute">name</span>=<span class="value">"main_layout"</span> <span class="attribute">type</span>=<span class="value">"layout"</span>&gt;</span>@layout/twopanes<span class="tag">&lt;/<span class="title">item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">bool</span> <span class="attribute">name</span>=<span class="value">"has_two_panes"</span>&gt;</span>true<span class="tag">&lt;/<span class="title">bool</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">resources</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>res/values-sw600dp-port/layouts.xml:<br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">item</span> <span class="attribute">name</span>=<span class="value">"main_layout"</span> <span class="attribute">type</span>=<span class="value">"layout"</span>&gt;</span>@layout/onepane<span class="tag">&lt;/<span class="title">item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">bool</span> <span class="attribute">name</span>=<span class="value">"has_two_panes"</span>&gt;</span>false<span class="tag">&lt;/<span class="title">bool</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">resources</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>res/values-large-land/layouts.xml:<br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">item</span> <span class="attribute">name</span>=<span class="value">"main_layout"</span> <span class="attribute">type</span>=<span class="value">"layout"</span>&gt;</span>@layout/twopanes<span class="tag">&lt;/<span class="title">item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">bool</span> <span class="attribute">name</span>=<span class="value">"has_two_panes"</span>&gt;</span>true<span class="tag">&lt;/<span class="title">bool</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">resources</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>res/values-large-port/layouts.xml:<br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">item</span> <span class="attribute">name</span>=<span class="value">"main_layout"</span> <span class="attribute">type</span>=<span class="value">"layout"</span>&gt;</span>@layout/twopanes_narrow<span class="tag">&lt;/<span class="title">item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">bool</span> <span class="attribute">name</span>=<span class="value">"has_two_panes"</span>&gt;</span>true<span class="tag">&lt;/<span class="title">bool</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">resources</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>##使用.9图片<br>使用.9图片使得图片资源随着控件的拉伸和拉伸。</p>
<p>#支持不同的屏幕密度<br>通过提供不同的资源和使用分辨率无关的度量单位来支持不同的屏幕密度。</p>
<p>##sp和dp<br>sp是scale-independent pixel，常常用于字体的大小；dp是density-independent pixel，常常用于控件的宽高。</p>
<p>##提供多套图片</p>
<blockquote>
<ul>
<li>xhdpi: 2.0</li>
<li>hdpi: 1.5</li>
<li>mdpi: 1.0 (baseline)</li>
<li>ldpi: 0.75 </li>
</ul>
</blockquote>
<p>#实现自适应的流UI<br>应用程序当前展示的layout的不同，UI也会不同，比如应用程序在双面板(dual-pane)模式和单面板(single-pane)模式下就不同。</p>
<p>##决定当前的布局<br>首先需要知道的是用户当前所处的是双面板模式还是单面板模式，可以通过查询给定view是否存在和可见去判断。<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NewsReaderActivity</span> <span class="keyword">extends</span> <span class="title">FragmentActivity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">boolean</span> mIsDualPane;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.main_layout);</span><br><span class="line"></span><br><span class="line">        View articleView = findViewById(R.id.article);</span><br><span class="line">        mIsDualPane = articleView != <span class="keyword">null</span> &amp;&amp; </span><br><span class="line">                        articleView.getVisibility() == View.VISIBLE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>另外一个例子就是在执行一个控件的动作之前，先去检查是否可用。在demo里面，会去检查一个打开menu的button(3.0以后，它的函数由ActionBar取代)<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Button catButton = (Button) findViewById(R.id.categorybutton);</span><br><span class="line">OnClickListener listener = <span class="comment">/* create your listener here */</span>;</span><br><span class="line"><span class="keyword">if</span> (catButton != <span class="keyword">null</span>) &#123;</span><br><span class="line">    catButton.setOnClickListener(listener);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>##根据当前的布局做出相应的操作<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="annotation">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onHeadlineSelected</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    mArtIndex = index;</span><br><span class="line">    <span class="keyword">if</span> (mIsDualPane) &#123;</span><br><span class="line">        <span class="comment">/* display article on the right pane */</span></span><br><span class="line">        mArticleFragment.displayArticle(mCurrentCat.getArticle(index));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">/* start a separate activity */</span></span><br><span class="line">        Intent intent = <span class="keyword">new</span> Intent(<span class="keyword">this</span>, ArticleActivity.class);</span><br><span class="line">        intent.putExtra(<span class="string">"catIndex"</span>, mCatIndex);</span><br><span class="line">        intent.putExtra(<span class="string">"artIndex"</span>, index);</span><br><span class="line">        startActivity(intent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在上面的平板横屏模式下是处于双面板模式的，我们看到上面有分类的导航。<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">final</span> String CATEGORIES[] = &#123; <span class="string">"Top Stories"</span>, <span class="string">"Politics"</span>, <span class="string">"Economy"</span>, <span class="string">"Technology"</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">    ....</span><br><span class="line">    <span class="keyword">if</span> (mIsDualPane) &#123;</span><br><span class="line">        <span class="comment">/* use tabs for navigation */</span></span><br><span class="line">        actionBar.setNavigationMode(android.app.ActionBar.NAVIGATION_MODE_TABS);</span><br><span class="line">        <span class="keyword">int</span> i;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; CATEGORIES.length; i++) &#123;</span><br><span class="line">            actionBar.addTab(actionBar.newTab().setText(</span><br><span class="line">                CATEGORIES[i]).setTabListener(handler));</span><br><span class="line">        &#125;</span><br><span class="line">        actionBar.setSelectedNavigationItem(selTab);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">/* use list navigation (spinner) */</span></span><br><span class="line">        actionBar.setNavigationMode(android.app.ActionBar.NAVIGATION_MODE_LIST);</span><br><span class="line">        SpinnerAdapter adap = <span class="keyword">new</span> ArrayAdapter(<span class="keyword">this</span>, </span><br><span class="line">                R.layout.headline_item, CATEGORIES);</span><br><span class="line">        actionBar.setListNavigationCallbacks(adap, handler);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>如果不是双面板的话，就直接使用Spinner代替了。</p>
<p>##在其他的Activity中重用Fragments<br>在demo里面，ArticleFragment是在双面板下使用的：<br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">LinearLayout</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    <span class="attribute">android:layout_width</span>=<span class="value">"fill_parent"</span></span><br><span class="line">    <span class="attribute">android:layout_height</span>=<span class="value">"fill_parent"</span></span><br><span class="line">    <span class="attribute">android:orientation</span>=<span class="value">"horizontal"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">fragment</span> <span class="attribute">android:id</span>=<span class="value">"@+id/headlines"</span></span><br><span class="line">              <span class="attribute">android:layout_height</span>=<span class="value">"fill_parent"</span></span><br><span class="line">              <span class="attribute">android:name</span>=<span class="value">"com.example.android.newsreader.HeadlinesFragment"</span></span><br><span class="line">              <span class="attribute">android:layout_width</span>=<span class="value">"400dp"</span></span><br><span class="line">              <span class="attribute">android:layout_marginRight</span>=<span class="value">"10dp"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">fragment</span> <span class="attribute">android:id</span>=<span class="value">"@+id/article"</span></span><br><span class="line">              <span class="attribute">android:layout_height</span>=<span class="value">"fill_parent"</span></span><br><span class="line">              <span class="attribute">android:name</span>=<span class="value">"com.example.android.newsreader.ArticleFragment"</span></span><br><span class="line">              <span class="attribute">android:layout_width</span>=<span class="value">"fill_parent"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>但是在单面板中，仍然可以使用它，如下：<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ArticleFragment frag = <span class="keyword">new</span> ArticleFragment();</span><br><span class="line">getSupportFragmentManager().beginTransaction().add(android.R.id.content, frag).commit();</span><br></pre></td></tr></table></figure></p>
<p>我们也会发现，单面板下才会启动的ArticleActivity是没有布局的。(也就是没有声明Fragment啊，这样不是重用了嘛)</p>
<blockquote>
<p>Naturally, this has the same effect as declaring the fragment in an XML layout, but in this case an XML layout is unnecessary work because the article fragment is the only component of this activity.<br>这和在xml布局中声明Fragment具有一样的效果，但是在这种情况下，article fragment只是它的宿主Activity的控件。</p>
</blockquote>
<p>Fragment和Fragment之间的通信是基于宿主Activity，当<code>HeadlinesFragment</code>点击新闻列表的某一个条目的时候，双面板下在<code>ArticleFragment</code>中显示新闻，单面板下启动新的Activity。<br>这个都是通过在<code>HeadlinesFragment</code>中定义接口，然后在宿主Activity中实现接口完成。如下：<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeadlinesFragment</span> <span class="keyword">extends</span> <span class="title">ListFragment</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    OnHeadlineSelectedListener mHeadlineSelectedListener = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Must be implemented by host activity */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OnHeadlineSelectedListener</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onHeadlineSelected</span><span class="params">(<span class="keyword">int</span> index)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOnHeadlineSelectedListener</span><span class="params">(OnHeadlineSelectedListener listener)</span> </span>&#123;</span><br><span class="line">        mHeadlineSelectedListener = listener;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>点击的时候：<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeadlinesFragment</span> <span class="keyword">extends</span> <span class="title">ListFragment</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onItemClick</span><span class="params">(AdapterView&lt;?&gt; parent, </span><br><span class="line">                            View view, <span class="keyword">int</span> position, <span class="keyword">long</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != mHeadlineSelectedListener) &#123;</span><br><span class="line">            mHeadlineSelectedListener.onHeadlineSelected(position);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>宿主Activity实现该接口：<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="annotation">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onHeadlineSelected</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">      mArtIndex = index;</span><br><span class="line">      <span class="keyword">if</span> (mIsDualPane) &#123;</span><br><span class="line">          <span class="comment">// display it on the article fragment</span></span><br><span class="line">          mArticleFragment.displayArticle(mCurrentCat.getArticle(index));</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// use separate activity</span></span><br><span class="line">          Intent i = <span class="keyword">new</span> Intent(<span class="keyword">this</span>, ArticleActivity.class);</span><br><span class="line">          i.putExtra(<span class="string">"catIndex"</span>, mCatIndex);</span><br><span class="line">          i.putExtra(<span class="string">"artIndex"</span>, index);</span><br><span class="line">          startActivity(i);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>关于Fragment之间的通信，在training for the first part中有详细的讲述。</p>
<p>##处理屏幕配置的改变<br>这个主要是解决屏幕旋转带来的问题：<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleActivity</span> <span class="keyword">extends</span> <span class="title">FragmentActivity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mCatIndex, mArtIndex;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        mCatIndex = getIntent().getExtras().getInt(<span class="string">"catIndex"</span>, <span class="number">0</span>);</span><br><span class="line">        mArtIndex = getIntent().getExtras().getInt(<span class="string">"artIndex"</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// If should be in two-pane mode, finish to return to main activity</span></span><br><span class="line">        <span class="keyword">if</span> (getResources().getBoolean(R.bool.has_two_panes)) &#123;</span><br><span class="line">            finish();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>#Demo源码分析<br>程序的入口是<code>NewsReaderActivity</code>，打开：<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * Main activity: shows headlines list and articles, if layout permits.</span><br><span class="line"> *</span><br><span class="line"> * This is the main activity of the application. It can have several different layouts depending</span><br><span class="line"> * on the SDK version, screen size and orientation. The configurations are divided in two large</span><br><span class="line"> * groups: single-pane layouts and dual-pane layouts.</span><br><span class="line"> *</span><br><span class="line"> * In single-pane mode, this activity shows a list of headlines using a &#123;<span class="doctag">@link</span> HeadlinesFragment&#125;.</span><br><span class="line"> * When the user clicks on a headline, a separate activity (a &#123;<span class="doctag">@link</span> ArticleActivity&#125;) is launched</span><br><span class="line"> * to show the news article.</span><br><span class="line"> *</span><br><span class="line"> * In dual-pane mode, this activity shows a &#123;<span class="doctag">@HeadlinesFragment</span>&#125; on the left side and an</span><br><span class="line"> * &#123;<span class="doctag">@ArticleFragment</span>&#125; on the right side. When the user selects a headline on the left, the</span><br><span class="line"> * corresponding article is shown on the right.</span><br><span class="line"> *</span><br><span class="line"> * If an Action Bar is available (large enough screen and SDK version 11 or up), navigation</span><br><span class="line"> * controls are shown in the Action Bar (whether to show tabs or a list depends on the layout).</span><br><span class="line"> * If an Action Bar is not available, a regular image and button are shown in the top area of</span><br><span class="line"> * the screen, emulating an Action Bar.</span><br><span class="line"> */</span></span><br><span class="line"> 提到的几点：</span><br><span class="line"> * `NewsReaderActivity`展示标题和内容，如果布局允许的话；</span><br><span class="line"> * 根据SDK的版本，屏幕的大小和方向它有不同的布局。整体配置上可以分为单面板模式和双面板模式。</span><br><span class="line"> * 在单面板模式下，该activity通过`HeadlinesFragment`展示文章的列表，当点击`HeadlinesFragment`的某一个条目的时候，会启动一个新的Activity：`ArticleActivity`.</span><br><span class="line"> * 在双面板模式下，左边展示的是`HeadlinesFragment`文章的列表，右边展示的是`ArticleFragment`文章的内容。</span><br><span class="line"> * 当ActionBar可用的时候，导航控制会在ActionBar中显示(根据布局的不同显示tabs或者list)，当ActionBar不可用的时候，使用其他的方式代替。</span><br><span class="line"> ```java</span><br><span class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NewsReaderActivity</span> <span class="keyword">extends</span> <span class="title">FragmentActivity</span></span><br><span class="line">        <span class="keyword">implements</span> <span class="title">HeadlinesFragment</span>.<span class="title">OnHeadlineSelectedListener</span>,</span><br><span class="line">                   <span class="title">CompatActionBarNavListener</span>,</span><br><span class="line">                   <span class="title">OnClickListener</span></span>&#123;&#125;</span><br><span class="line">```				  </span><br><span class="line">实现了三个接口，第一个是用于Fragments之间的通信用的，第三个是点击事件的，看看第二个：</span><br><span class="line">```java</span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * A listener that listens to navigation events.</span><br><span class="line"> *</span><br><span class="line"> * Represents a listener for navigation events delivered by &#123;<span class="doctag">@link</span> CompatActionBarNavHandler&#125;.</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CompatActionBarNavListener</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * Signals that the given news category was selected.</span><br><span class="line">     * <span class="doctag">@param</span> catIndex the selected category's index.</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCategorySelected</span><span class="params">(<span class="keyword">int</span> catIndex)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>该接口负责监听导航事件，提供了<code>public void onCategorySelected(int catIndex);</code>方法，该方法传入整形<code>catIndex</code>表明选中的分类信息，该类和<code>CompatActionBarNavHandler</code>有联系：<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * Adapter for action bar navigation events.</span><br><span class="line"> *</span><br><span class="line"> * This class implements an adapter that facilitates handling of action bar navigation events.</span><br><span class="line"> * An instance of this class must be installed as a TabListener or OnNavigationListener on an</span><br><span class="line"> * Action Bar, and it will relay the navigation events to a configured listener</span><br><span class="line"> * (a &#123;<span class="doctag">@link</span> CompatActionBarNavListener&#125;).</span><br><span class="line"> *</span><br><span class="line"> * This class should only be instanced and used on Android platforms that support the Action Bar,</span><br><span class="line"> * that is, SDK level 11 and above.</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CompatActionBarNavHandler</span> <span class="keyword">implements</span> <span class="title">TabListener</span>, <span class="title">OnNavigationListener</span> </span>&#123;</span><br><span class="line">    <span class="comment">// The listener that we notify of navigation events</span></span><br><span class="line">    CompatActionBarNavListener mNavListener;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * Constructs an instance with the given listener.</span><br><span class="line">     *</span><br><span class="line">     * <span class="doctag">@param</span> listener the listener to notify when a navigation event occurs.</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CompatActionBarNavHandler</span><span class="params">(CompatActionBarNavListener listener)</span> </span>&#123;</span><br><span class="line">        mNavListener = listener;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * Called by framework when a tab is selected.</span><br><span class="line">     *</span><br><span class="line">     * This will cause a navigation event to be delivered to the configured listener.</span><br><span class="line">     */</span></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onTabSelected</span><span class="params">(Tab tab, FragmentTransaction ft)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        mNavListener.onCategorySelected(tab.getPosition());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * Called by framework when a item on the navigation menu is selected.</span><br><span class="line">     *</span><br><span class="line">     * This will cause a navigation event to be delivered to the configured listener.</span><br><span class="line">     */</span></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onNavigationItemSelected</span><span class="params">(<span class="keyword">int</span> itemPosition, <span class="keyword">long</span> itemId)</span> </span>&#123;</span><br><span class="line">        mNavListener.onCategorySelected(itemPosition);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * Called by framework when a tab is re-selected. That is, it was already selected and is</span><br><span class="line">     * tapped on again. This is not used in our app.</span><br><span class="line">     */</span></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onTabReselected</span><span class="params">(Tab tab, FragmentTransaction ft)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// we don't care</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * Called by framework when a tab is unselected. Not used in our app.</span><br><span class="line">     */</span></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onTabUnselected</span><span class="params">(Tab tab, FragmentTransaction ft)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// we don't care</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>该类负责处理导航事件。并在构造器中传入了上面定义的接口。在重写的几个方法中，都是接口中的方法去接管。回到主Activity中。<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Whether or not we are in dual-pane mode</span></span><br><span class="line">  <span class="keyword">boolean</span> mIsDualPane = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// The fragment where the headlines are displayed</span></span><br><span class="line">  HeadlinesFragment mHeadlinesFragment;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// The fragment where the article is displayed (null if absent)</span></span><br><span class="line">  ArticleFragment mArticleFragment;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// The news category and article index currently being displayed</span></span><br><span class="line">  <span class="keyword">int</span> mCatIndex = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">int</span> mArtIndex = <span class="number">0</span>;</span><br><span class="line">  NewsCategory mCurrentCat;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// List of category titles</span></span><br><span class="line">  <span class="keyword">final</span> String CATEGORIES[] = &#123; <span class="string">"Top Stories"</span>, <span class="string">"Politics"</span>, <span class="string">"Economy"</span>, <span class="string">"Technology"</span> &#125;;</span><br></pre></td></tr></table></figure></p>
<p>这些fields都是很好理解的。<code>mCatIndex</code>是分类信息的索引，<code>mArtIndex</code>是新闻列表(上面说成了文章列表、、、、)的索引。<code>NewsCategory</code>是文章的分类信息，那么看下这个类吧：<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * A news category (collection of articles).</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NewsCategory</span> </span>&#123;</span><br><span class="line">    <span class="comment">// how many articles?</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> ARTICLES_PER_CATEGORY = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// array of our articles</span></span><br><span class="line">    NewsArticle[] mArticles;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * Create a news category.</span><br><span class="line">     *</span><br><span class="line">     * The articles are dynamically generated with fun and random nonsense.</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">NewsCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        NonsenseGenerator ngen = <span class="keyword">new</span> NonsenseGenerator();</span><br><span class="line">        mArticles = <span class="keyword">new</span> NewsArticle[ARTICLES_PER_CATEGORY];</span><br><span class="line">        <span class="keyword">int</span> i;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; mArticles.length; i++) &#123;</span><br><span class="line">            mArticles[i] = <span class="keyword">new</span> NewsArticle(ngen);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Returns how many articles exist in this category. */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getArticleCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mArticles.length;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Gets a particular article by index. */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> NewsArticle <span class="title">getArticle</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mArticles[index];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>看到每个分类的新闻列表是20条数据，对应的NewsArticle也就是有20条的数据。并且提供了返回新闻数量的方法和返回新闻内容的方法。里面提到的<code>NonsenseGenerator</code>，这个类是用来生成新闻列表和内容的类。<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span><br><span class="line"> * Copyright (C) 2011 The Android Open Source Project</span><br><span class="line"> *</span><br><span class="line"> * Licensed under the Apache License, Version 2.0 (the "License");</span><br><span class="line"> * you may not use this file except in compliance with the License.</span><br><span class="line"> * You may obtain a copy of the License at</span><br><span class="line"> *</span><br><span class="line"> *      http://www.apache.org/licenses/LICENSE-2.0</span><br><span class="line"> *</span><br><span class="line"> * Unless required by applicable law or agreed to in writing, software</span><br><span class="line"> * distributed under the License is distributed on an "AS IS" BASIS,</span><br><span class="line"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><br><span class="line"> * See the License for the specific language governing permissions and</span><br><span class="line"> * limitations under the License.</span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.example.android.newsreader;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Generator of random news. More fun than "lorem ipsum", isn't it?</span><br><span class="line"> *</span><br><span class="line"> * This generator can construct headlines and news articles by randomly composing sentences.</span><br><span class="line"> * Any resemblance to actual events (or, actually, any resemblance to anything that makes sense)</span><br><span class="line"> * is merely coincidental!</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NonsenseGenerator</span> </span>&#123;</span><br><span class="line">    Random mRandom;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> String[] THINGS = &#123; <span class="string">"bottle"</span>, <span class="string">"bowl"</span>, <span class="string">"brick"</span>, <span class="string">"building"</span>,</span><br><span class="line">            <span class="string">"bunny"</span>, <span class="string">"cake"</span>, <span class="string">"car"</span>, <span class="string">"cat"</span>, <span class="string">"cup"</span>, <span class="string">"desk"</span>, <span class="string">"dog"</span>, <span class="string">"duck"</span>,</span><br><span class="line">            <span class="string">"elephant"</span>, <span class="string">"engineer"</span>, <span class="string">"fork"</span>, <span class="string">"glass"</span>, <span class="string">"griffon"</span>, <span class="string">"hat"</span>, <span class="string">"key"</span>, <span class="string">"knife"</span>, <span class="string">"lawyer"</span>,</span><br><span class="line">            <span class="string">"llama"</span>, <span class="string">"manual"</span>, <span class="string">"meat"</span>, <span class="string">"monitor"</span>, <span class="string">"mouse"</span>, <span class="string">"tangerine"</span>, <span class="string">"paper"</span>, <span class="string">"pear"</span>, <span class="string">"pen"</span>,</span><br><span class="line">            <span class="string">"pencil"</span>, <span class="string">"phone"</span>, <span class="string">"physicist"</span>, <span class="string">"planet"</span>, <span class="string">"potato"</span>, <span class="string">"road"</span>, <span class="string">"salad"</span>, <span class="string">"shoe"</span>, <span class="string">"slipper"</span>,</span><br><span class="line">            <span class="string">"soup"</span>, <span class="string">"spoon"</span>, <span class="string">"star"</span>, <span class="string">"steak"</span>, <span class="string">"table"</span>, <span class="string">"terminal"</span>, <span class="string">"treehouse"</span>, <span class="string">"truck"</span>,</span><br><span class="line">            <span class="string">"watermelon"</span>, <span class="string">"window"</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> String[] ADJECTIVES = &#123; <span class="string">"red"</span>, <span class="string">"green"</span>, <span class="string">"yellow"</span>, <span class="string">"gray"</span>, <span class="string">"solid"</span>, <span class="string">"fierce"</span>,</span><br><span class="line">            <span class="string">"friendly"</span>, <span class="string">"cowardly"</span>, <span class="string">"convenient"</span>, <span class="string">"foreign"</span>, <span class="string">"national"</span>, <span class="string">"tall"</span>,</span><br><span class="line">            <span class="string">"short"</span>, <span class="string">"metallic"</span>, <span class="string">"golden"</span>, <span class="string">"silver"</span>, <span class="string">"sweet"</span>, <span class="string">"nationwide"</span>, <span class="string">"competitive"</span>,</span><br><span class="line">            <span class="string">"stable"</span>, <span class="string">"municipal"</span>, <span class="string">"famous"</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> String[] VERBS_PAST = &#123; <span class="string">"accused"</span>, <span class="string">"threatened"</span>, <span class="string">"warned"</span>, <span class="string">"spoke to"</span>,</span><br><span class="line">            <span class="string">"has met with"</span>,</span><br><span class="line">            <span class="string">"was seen in the company of"</span>, <span class="string">"advanced towards"</span>, <span class="string">"collapsed on"</span>,</span><br><span class="line">            <span class="string">"signed a partnership with"</span>, <span class="string">"was converted into"</span>, <span class="string">"became"</span>, <span class="string">"was authorized to sell"</span>,</span><br><span class="line">            <span class="string">"sold"</span>, <span class="string">"bought"</span>, <span class="string">"rented"</span>, <span class="string">"allegedly spoke to"</span>, <span class="string">"leased"</span>, <span class="string">"is now investing on"</span>,</span><br><span class="line">            <span class="string">"is expected to buy"</span>, <span class="string">"is expected to sell"</span>, <span class="string">"was reported to have met with"</span>,</span><br><span class="line">            <span class="string">"will work together with"</span>, <span class="string">"plans to cease fire against"</span>, <span class="string">"started a war with"</span>,</span><br><span class="line">            <span class="string">"signed a truce with"</span>, <span class="string">"is now managing"</span>, <span class="string">"is investigating"</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> String[] VERBS_PRESENT = &#123; <span class="string">"accuses"</span>, <span class="string">"threatens"</span>, <span class="string">"warns"</span>, <span class="string">"speaks to"</span>,</span><br><span class="line">            <span class="string">"meets with"</span>,</span><br><span class="line">            <span class="string">"seen with"</span>, <span class="string">"advances towards"</span>, <span class="string">"collapses on"</span>,</span><br><span class="line">            <span class="string">"signs partnership with"</span>, <span class="string">"converts into"</span>, <span class="string">"becomes"</span>, <span class="string">"is authorized to sell"</span>,</span><br><span class="line">            <span class="string">"sells"</span>, <span class="string">"buys"</span>, <span class="string">"rents"</span>, <span class="string">"allegedly speaks to"</span>, <span class="string">"leases"</span>, <span class="string">"invests on"</span>,</span><br><span class="line">            <span class="string">"expected to buy"</span>, <span class="string">"expected to sell"</span>, <span class="string">"reported to have met with"</span>,</span><br><span class="line">            <span class="string">"works together with"</span>, <span class="string">"plans cease fire against"</span>, <span class="string">"starts war with"</span>,</span><br><span class="line">            <span class="string">"signs truce with"</span>, <span class="string">"now manages"</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">NonsenseGenerator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mRandom = <span class="keyword">new</span> Random();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Produces something that reads like a headline. */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">makeHeadline</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> makeSentence(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Produces a sentence.</span><br><span class="line">     *</span><br><span class="line">     * <span class="doctag">@param</span> isHeadline whether the sentence should look like a headline or not.</span><br><span class="line">     * <span class="doctag">@return</span> the generated sentence.</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">makeSentence</span><span class="params">(<span class="keyword">boolean</span> isHeadline)</span> </span>&#123;</span><br><span class="line">        List&lt;String&gt; words = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">        generateSentence(words, isHeadline);</span><br><span class="line">        words.set(<span class="number">0</span>, String.valueOf(Character.toUpperCase(words.get(<span class="number">0</span>).charAt(<span class="number">0</span>))) +</span><br><span class="line">                words.get(<span class="number">0</span>).substring(<span class="number">1</span>));</span><br><span class="line">        <span class="keyword">return</span> joinWords(words);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Produces news article text.</span><br><span class="line">     *</span><br><span class="line">     * <span class="doctag">@param</span> numSentences how many sentences the text is to contain.</span><br><span class="line">     * <span class="doctag">@return</span> the generated text.</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">makeText</span><span class="params">(<span class="keyword">int</span> numSentences)</span> </span>&#123;</span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">while</span> (numSentences-- &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            sb.append(makeSentence(<span class="keyword">false</span>) + <span class="string">"."</span>);</span><br><span class="line">            <span class="keyword">if</span> (numSentences &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                sb.append(<span class="string">" "</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Generates a sentence.</span><br><span class="line">     *</span><br><span class="line">     * <span class="doctag">@param</span> words the list of words to which the sentence will be appended.</span><br><span class="line">     * <span class="doctag">@param</span> isHeadline whether the sentence must look like a headline or not.</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">generateSentence</span><span class="params">(List&lt;String&gt; words, <span class="keyword">boolean</span> isHeadline)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!isHeadline &amp;&amp; mRandom.nextInt(<span class="number">4</span>) == <span class="number">0</span>)</span><br><span class="line">            generateTimeClause(words, isHeadline);</span><br><span class="line">        generateAgent(words, isHeadline);</span><br><span class="line">        generatePredicate(words, isHeadline);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">generateTimeClause</span><span class="params">(List&lt;String&gt; words, <span class="keyword">boolean</span> isHeadline)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (mRandom.nextInt(<span class="number">2</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">            words.add(pickOneOf(<span class="string">"today"</span>, <span class="string">"yesterday"</span>, <span class="string">"this afternoon"</span>, <span class="string">"this morning"</span>,</span><br><span class="line">                    <span class="string">"last evening"</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            words.add(pickOneOf(<span class="string">"this"</span>, <span class="string">"last"</span>));</span><br><span class="line">            words.add(pickOneOf(<span class="string">"Monday"</span>, <span class="string">"Tuesday"</span>, <span class="string">"Wednesday"</span>, <span class="string">"Thursday"</span>));</span><br><span class="line">            words.add(pickOneOf(<span class="string">"morning"</span>, <span class="string">"afternoon"</span>, <span class="string">"evening"</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">generateAgent</span><span class="params">(List&lt;String&gt; words, <span class="keyword">boolean</span> isHeadline)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">if</span> (!isHeadline) &#123;</span><br><span class="line">           words.add(pickOneOf(<span class="string">"a"</span>, <span class="string">"the"</span>));</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">if</span> (mRandom.nextInt(<span class="number">3</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">           words.add(pickOneOf(ADJECTIVES));</span><br><span class="line">       &#125;</span><br><span class="line">       words.add(pickOneOf(THINGS));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">generatePredicate</span><span class="params">(List&lt;String&gt; words, <span class="keyword">boolean</span> isHeadline)</span> </span>&#123;</span><br><span class="line">        words.add(pickOneOf(isHeadline ? VERBS_PRESENT : VERBS_PAST));</span><br><span class="line">        <span class="keyword">if</span> (!isHeadline)</span><br><span class="line">            words.add(pickOneOf(<span class="string">"a"</span>, <span class="string">"the"</span>));</span><br><span class="line">        <span class="keyword">if</span> (mRandom.nextInt(<span class="number">3</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            words.add(pickOneOf(ADJECTIVES));</span><br><span class="line">        &#125;</span><br><span class="line">        words.add(pickOneOf(THINGS));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (mRandom.nextInt(<span class="number">3</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">            words.add(isHeadline ? pickOneOf(<span class="string">", claims"</span>, <span class="string">", says"</span>) :</span><br><span class="line">                 pickOneOf(<span class="string">", claimed"</span>, <span class="string">", said"</span>, <span class="string">", reported"</span>));</span><br><span class="line">            <span class="keyword">if</span> (!isHeadline)</span><br><span class="line">                words.add(pickOneOf(<span class="string">"a"</span>, <span class="string">"the"</span>));</span><br><span class="line">            <span class="keyword">if</span> (mRandom.nextInt(<span class="number">3</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">                words.add(pickOneOf(ADJECTIVES));</span><br><span class="line">            &#125;</span><br><span class="line">            words.add(pickOneOf(THINGS));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">pickOneOf</span><span class="params">(String ... options)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> options[mRandom.nextInt(options.length)];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">joinWords</span><span class="params">(List&lt;String&gt; words)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i;</span><br><span class="line">        <span class="keyword">if</span> (words.size() == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        sb.append(words.get(<span class="number">0</span>));</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; words.size(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!words.get(i).startsWith(<span class="string">","</span>)) &#123;</span><br><span class="line">                sb.append(<span class="string">" "</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            sb.append(words.get(i));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>我们不关心这个，只要知道它的作用即可。现在回到主Activity中：<br>接着是onCreate()方法：<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="annotation">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">       setContentView(R.layout.main_layout);</span><br><span class="line"></span><br><span class="line">       <span class="comment">// find our fragments</span></span><br><span class="line">       mHeadlinesFragment = (HeadlinesFragment) getSupportFragmentManager().findFragmentById(</span><br><span class="line">               R.id.headlines);</span><br><span class="line">       mArticleFragment = (ArticleFragment) getSupportFragmentManager().findFragmentById(</span><br><span class="line">               R.id.article);</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Determine whether we are in single-pane or dual-pane mode by testing the visibility</span></span><br><span class="line">       <span class="comment">// of the article view.</span></span><br><span class="line">       View articleView = findViewById(R.id.article);</span><br><span class="line">       mIsDualPane = articleView != <span class="keyword">null</span> &amp;&amp; articleView.getVisibility() == View.VISIBLE;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Register ourselves as the listener for the headlines fragment events.</span></span><br><span class="line">       mHeadlinesFragment.setOnHeadlineSelectedListener(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Set up the Action Bar (or not, if one is not available)</span></span><br><span class="line">       <span class="keyword">int</span> catIndex = savedInstanceState == <span class="keyword">null</span> ? <span class="number">0</span> : savedInstanceState.getInt(<span class="string">"catIndex"</span>, <span class="number">0</span>);</span><br><span class="line">       setUpActionBar(mIsDualPane, catIndex);</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Set up headlines fragment</span></span><br><span class="line">       mHeadlinesFragment.setSelectable(mIsDualPane);</span><br><span class="line">       restoreSelection(savedInstanceState);</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Set up the category button (shown if an Action Bar is not available)</span></span><br><span class="line">       Button catButton = (Button) findViewById(R.id.categorybutton);</span><br><span class="line">       <span class="keyword">if</span> (catButton != <span class="keyword">null</span>) &#123;</span><br><span class="line">           catButton.setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p>
<p>布局是<code>main_layout.xml</code>，按住ctrl点开看布局源码，发现很多可选项，这里就是通过上面介绍的<code>Use Orientation Qualifiers</code>和<code>Use Layout Aliases</code>去做的，具体的参见源码和上面的介绍。<br>接着是找到两个Fragment，再去判断是双面板还是单面板(通过article view的存在和是否可见去判断)。下面是注册监听，接着通过<code>savedInstanceState</code>获取可能因为运行时配置的改变而改变的分类的索引。<br><code>setUpActionBar(mIsDualPane, catIndex);</code>的源码：<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/** Sets up Action Bar (if present).</span><br><span class="line">    *</span><br><span class="line">    * <span class="doctag">@param</span> showTabs whether to show tabs (if false, will show list).</span><br><span class="line">    * <span class="doctag">@param</span> selTab the selected tab or list item.</span><br><span class="line">    */</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUpActionBar</span><span class="params">(<span class="keyword">boolean</span> showTabs, <span class="keyword">int</span> selTab)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">if</span> (Build.VERSION.SDK_INT &lt; <span class="number">11</span>) &#123;</span><br><span class="line">           <span class="comment">// No action bar for you!</span></span><br><span class="line">           <span class="comment">// But do not despair. In this case the layout includes a bar across the</span></span><br><span class="line">           <span class="comment">// top that looks and feels like an action bar, but is made up of regular views.</span></span><br><span class="line">           <span class="keyword">return</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       android.app.ActionBar actionBar = getActionBar();</span><br><span class="line">       actionBar.setDisplayShowTitleEnabled(<span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Set up a CompatActionBarNavHandler to deliver us the Action Bar nagivation events</span></span><br><span class="line">       CompatActionBarNavHandler handler = <span class="keyword">new</span> CompatActionBarNavHandler(<span class="keyword">this</span>);</span><br><span class="line">       <span class="keyword">if</span> (showTabs) &#123;</span><br><span class="line">           actionBar.setNavigationMode(android.app.ActionBar.NAVIGATION_MODE_TABS);</span><br><span class="line">           <span class="keyword">int</span> i;</span><br><span class="line">           <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; CATEGORIES.length; i++) &#123;</span><br><span class="line">               actionBar.addTab(actionBar.newTab().setText(CATEGORIES[i]).setTabListener(handler));</span><br><span class="line">           &#125;</span><br><span class="line">           actionBar.setSelectedNavigationItem(selTab);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">else</span> &#123;</span><br><span class="line">           actionBar.setNavigationMode(android.app.ActionBar.NAVIGATION_MODE_LIST);</span><br><span class="line">           SpinnerAdapter adap = <span class="keyword">new</span> ArrayAdapter&lt;String&gt;(<span class="keyword">this</span>, R.layout.actionbar_list_item,</span><br><span class="line">                   CATEGORIES);</span><br><span class="line">           actionBar.setListNavigationCallbacks(adap, handler);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Show logo instead of icon+title.</span></span><br><span class="line">       actionBar.setDisplayUseLogoEnabled(<span class="keyword">true</span>);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p>
<p>代码上面已经介绍过了。<br>其他的也已经相继介绍过了。在demo中，值得学习的是如何处理适配，Fragment的用法，Fragment之间的通信。ActionBar的导航。其他的可以不用管。</p>
<p>#源码<br><a href="https://github.com/leerduo/NewsReader3" target="_blank" rel="external">源代码</a></p>

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/UI-UE/" rel="tag">#UI/UE</a>
          
            <a href="/tags/移动开发/" rel="tag">#移动开发</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/06/26/training-for-the-eighth-part/" rel="next" title="training for the eighth part">
                <i class="fa fa-chevron-left"></i> training for the eighth part
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/06/30/training-for-the-eleventh-part/" rel="prev" title="training for the eleventh part">
                training for the eleventh part <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2015/06/29/training-for-the-ninth-part/"
           data-title="training for the ninth part" data-url="http://chenfuduo.me/2015/06/29/training-for-the-ninth-part/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://duoinfo.sinaapp.com/yiyou/files/avatar.png"
               alt="louis.chen" />
          <p class="site-author-name" itemprop="name">louis.chen</p>
          <p class="site-description motion-element" itemprop="description">移动开发者,极端产品控。</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">76</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            
              <span class="site-state-item-count">6</span>
              <span class="site-state-item-name">分类</span>
              
          </div>

          <div class="site-state-item site-state-tags">
            
              <span class="site-state-item-count">13</span>
              <span class="site-state-item-name">标签</span>
              
          </div>

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/leerduo" target="_blank">
                  
                    <i class="fa fa-globe"></i> github
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/duoduoustc" target="_blank">
                  
                    <i class="fa fa-globe"></i> weibo
                  
                </a>
              </span>
            
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
            <p class="site-author-name">Links</p>
            
              <span class="links-of-author-item">
                <a href="http://www.vogella.com/tutorials/android.html" target="_blank">Vogella</a>
              </span>
            
          
        </div>

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc-indicator-top post-toc-indicator">
            <i class="fa fa-angle-double-up"></i>
          </div>
          <div class="post-toc">
            
              
            
            
              <p class="post-toc-empty">此文章未包含目录</p>
            
          </div>
          <div class="post-toc-indicator-bottom post-toc-indicator">
            <i class="fa fa-angle-double-down"></i>
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="icon-next-heart fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">louis.chen</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  


  



  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  

  
  
<script type="text/javascript" src="/js/src/scrollspy.js?v=0.5.0"></script>

<script type="text/javascript" id="sidebar.toc.highlight">
  $(document).ready(function () {
    var tocSelector = '.post-toc';
    var $tocSelector = $(tocSelector);
    var activeCurrentSelector = '.active-current';

    $tocSelector
      .on('activate.bs.scrollspy', function () {
        var $currentActiveElement = $(tocSelector + ' .active').last();

        removeCurrentActiveClass();
        $currentActiveElement.addClass('active-current');

        $tocSelector[0].scrollTop = $currentActiveElement.position().top;
      })
      .on('clear.bs.scrollspy', function () {
        removeCurrentActiveClass();
      });

    function removeCurrentActiveClass () {
      $(tocSelector + ' ' + activeCurrentSelector)
        .removeClass(activeCurrentSelector.substring(1));
    }

    function processTOC () {
      getTOCMaxHeight();
      toggleTOCOverflowIndicators();
    }

    function getTOCMaxHeight () {
      var height = $('.sidebar').height() -
                   $tocSelector.position().top -
                   $('.post-toc-indicator-bottom').height();

      $tocSelector.css('height', height);

      return height;
    }

    function toggleTOCOverflowIndicators () {
      tocOverflowIndicator(
        '.post-toc-indicator-top',
        $tocSelector.scrollTop() > 0 ? 'show' : 'hide'
      );

      tocOverflowIndicator(
        '.post-toc-indicator-bottom',
        $tocSelector.scrollTop() >= $tocSelector.find('ol').height() - $tocSelector.height() ? 'hide' : 'show'
      )
    }

    $(document).on('sidebar.motion.complete', function () {
      processTOC();
    });

    $('body').scrollspy({ target: tocSelector });
    $(window).on('resize', function () {
      if ( $('.sidebar').hasClass('sidebar-active') ) {
        processTOC();
      }
    });

    onScroll($tocSelector);

    function onScroll (element) {
      element.on('mousewheel DOMMouseScroll', function (event) {
          var oe = event.originalEvent;
          var delta = oe.wheelDelta || -oe.detail;

          this.scrollTop += ( delta < 0 ? 1 : -1 ) * 30;
          event.preventDefault();

          toggleTOCOverflowIndicators();
      });
    }

    function tocOverflowIndicator (indicator, action) {
      var $indicator = $(indicator);
      var opacity = action === 'show' ? 1 : 0;
      $indicator.velocity ?
        $indicator.velocity('stop').velocity({
          opacity: opacity
        }, { duration: 100 }) :
        $indicator.stop().animate({
          opacity: opacity
        }, 100);
    }

  });
</script>

<script type="text/javascript" id="sidebar.nav">
  $(document).ready(function () {
    var html = $('html');
    var TAB_ANIMATE_DURATION = 200;
    var hasVelocity = $.isFunction(html.velocity);

    $('.sidebar-nav li').on('click', function () {
      var item = $(this);
      var activeTabClassName = 'sidebar-nav-active';
      var activePanelClassName = 'sidebar-panel-active';
      if (item.hasClass(activeTabClassName)) {
        return;
      }

      var currentTarget = $('.' + activePanelClassName);
      var target = $('.' + item.data('target'));

      hasVelocity ?
        currentTarget.velocity('transition.slideUpOut', TAB_ANIMATE_DURATION, function () {
          target
            .velocity('stop')
            .velocity('transition.slideDownIn', TAB_ANIMATE_DURATION)
            .addClass(activePanelClassName);
        }) :
        currentTarget.animate({ opacity: 0 }, TAB_ANIMATE_DURATION, function () {
          currentTarget.hide();
          target
            .stop()
            .css({'opacity': 0, 'display': 'block'})
            .animate({ opacity: 1 }, TAB_ANIMATE_DURATION, function () {
              currentTarget.removeClass(activePanelClassName);
              target.addClass(activePanelClassName);
            });
        });

      item.siblings().removeClass(activeTabClassName);
      item.addClass(activeTabClassName);
    });

    $('.post-toc a').on('click', function (e) {
      e.preventDefault();
      var targetSelector = NexT.utils.escapeSelector(this.getAttribute('href'));
      var offset = $(targetSelector).offset().top;
      hasVelocity ?
        html.velocity('stop').velocity('scroll', {
          offset: offset  + 'px',
          mobileHA: false
        }) :
        $('html, body').stop().animate({
          scrollTop: offset
        }, 500);
    });

    // Expand sidebar on post detail page by default, when post has a toc.
    NexT.motion.middleWares.sidebar = function () {
      var $tocContent = $('.post-toc-content');

      if (CONFIG.sidebar === 'post') {
        if ($tocContent.length > 0 && $tocContent.html().trim().length > 0) {
          NexT.utils.displaySidebar();
        }
      }
    };
  });
</script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"chenfuduo"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  





  
  

  
  


</body>
</html>
